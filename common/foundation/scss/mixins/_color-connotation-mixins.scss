@use 'sass:selector';

@use '../variable-names/color-semantic-variable-names' as color-semantic;
@use '../functions';

// override to apply relevance
$connotations: primary cta success alert warning info announcement !default;
$connotation-placeholder: '[connotation-specifier]' !default;
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
$all-connotations: (
	primary: 'primary',
	cta: 'cta',
	success: 'success',
	alert: 'alert',
	warning: 'warning',
	info: 'info',
	announcement: 'announcement',
);

// selector can be altered by relevance
@mixin connotations-context(
	$selector: ':host(#{$connotation-placeholder})',
	$default-fallback: null
) {
	@each $connotation in functions.pick($connotations, $all-connotations) {
		$attr: '[connotation="#{$connotation}" i]';

		$scoped-selector: $selector; // prevents overriding argument

		$scoped-selector: selector.replace(
			#{$selector},
			#{$connotation-placeholder},
			#{$attr}
		);

		#{$scoped-selector} {
			#{color-semantic.$vvd-color-connotation}: var(--vvd-color-#{$connotation});
			#{color-semantic.$vvd-color-on-connotation}: var(
				--vvd-color-on-#{$connotation}
			);
		}
	}

	// add default fallback if/when required
	@if ($default-fallback) {
		$processed-selector: selector.replace(
			#{$selector},
			#{$connotation-placeholder},
			':not([connotation])'
		);

		#{$processed-selector} {
			#{color-semantic.$vvd-color-connotation}: var(
				--vvd-color-#{$default-fallback}
			);
			#{color-semantic.$vvd-color-on-connotation}: var(
				--vvd-color-on-#{$default-fallback}
			);
		}
	}
}
