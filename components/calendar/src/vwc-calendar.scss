@use '@vonage/vvd-design-tokens/build/scss/semantic-variables/scheme-variables';
@use '@vonage/vvd-typography/scss/typography';

ol {
	list-style: none;
	margin: 0;
	padding: 0;
}

$fraction: 4;
$total-rows: 15;
$total-columns: 7;

.container {
	width: max(100%, 500px);
	margin: auto;
	display: grid;
	grid-template-columns: min-content auto;
	grid-template-areas:
		'. headline'
		'time calendar';
}

ol.time {
	grid-area: time;
	display: grid;
	grid-template-rows: repeat($total-rows, 1fr);
	margin-inline-end: 15px;
	> li {
		display: flex;
		align-items: flex-end;
		justify-content: flex-end;
		> time {
			line-height: 1;
			font-size: small;
			white-space: nowrap;
			@include typography.typography-cat-shorthand('caption');
			text-transform: uppercase;
		}
	}
}

ol.headline {
	grid-area: headline;
	display: grid;
	grid-template-columns: repeat($total-columns, 1fr);
	> li > time {
		@include typography.typography-cat-shorthand('caption');
		text-transform: uppercase;
	}
}

ol.calendar {
	grid-area: calendar;
	display: grid;
	gap: 1px;
	grid-template: repeat($total-rows * $fraction, 1fr) / repeat(
			$total-columns,
			1fr
		);
	grid-auto-flow: column;
	background-color: var(#{scheme-variables.$vvd-color-contrast-faint});
	box-shadow: 0px 0 3.64752px rgba(0, 0, 0, 0.15);
	border-radius: 3.64752px;
	overflow: hidden;
	> li {
		height: 35px;
		grid-column: var(--column);
		grid-row: var(--row);
		background-color: var(#{scheme-variables.$vvd-color-base});
	}

	@for $i from 1 through $total-rows {
		$current-row: $i * $fraction - $fraction + 1;
		li:nth-child(#{$total-rows}n + #{$i}) {
			--row: #{$current-row} / span #{$fraction};
		}
	}

	$sum: $total-rows * $total-columns;
	$next: 1;
	@for $i from 1 through $total-columns {
		$sum: $sum - $total-rows + 1;
		li:nth-child(1n + #{$next}):nth-last-child(1n + #{$sum}) {
			--column: #{$i};
		}
		$next: $next + $total-rows;
	}
}

.task {
	grid-column: var(--column);
	grid-row: var(--row);
	background-color: var(--color);
	border-radius: 3.64752px;
	// width: 90%;
	--indent: calc(var(--overlap-count, 0) * 8px);
	margin: 1px 1px 1px calc(1px + var(--indent));
}
